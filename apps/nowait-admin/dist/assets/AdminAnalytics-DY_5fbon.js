import{j as e,r as N}from"./index-DWRamT31.js";import{u as f}from"./useQuery-CQz0YXSa.js";import{A as y}from"./AdminApi-BnHrq_k2.js";import{u as v}from"./useWindowWidth-hcMhglfJ.js";const S=async()=>(await y.get("/admin/statistics/popular-menu")).data.response,b=()=>f({queryKey:["popular-menu"],queryFn:S,staleTime:1e3*60*5}),k=async t=>{const n=(await y.get("/admin/statistics/sales",{params:{date:t}})).data.response;return typeof n=="string"?void 0:n},D=t=>f({queryKey:["sales-by-date",t],queryFn:()=>k(t),enabled:!!t,staleTime:1e3*60}),F=async()=>(await y.get("/admin/statistics/top-sales")).data.response,$=()=>f({queryKey:["top-sales"],queryFn:F,staleTime:1e3*60*5}),A=t=>{const c=new Date(t);if(isNaN(c.getTime()))return t;const n=c.getFullYear(),r=String(c.getMonth()+1).padStart(2,"0"),s=String(c.getDate()).padStart(2,"0"),i=["일","월","화","수","목","금","토"][c.getDay()];return`${n}.${r}.${s} ${i}`},I=({date:t,data:c,disabled:n,isTablet:r})=>e.jsxs("div",{className:`bg-white rounded-[16px] mt-[10px] ${n?"w-full flex flex-col justify-center items-center relative":""} ${r?"h-[364px] max-h-[50%] p-6 w-full":"max-w-[335px] h-[410px] p-[22px]"}`,children:[e.jsx("div",{className:`flex w-full justify-between mb-4 ${n?"absolute left-[22px] top-[22px] w-[710px]":""}`,children:e.jsxs("div",{className:"flex w-full items-center justify-between ",children:[e.jsx("h2",{className:"text-title-18-bold text-navy-80",children:"부스별 판매순위"}),e.jsx("span",{className:"flex text-[12px] text-gray-400 items-center absolute right-[48px]",children:A(t)})]})}),n&&e.jsxs("div",{className:"flex flex-col justify-center items-center text-black-60 text-13-regular",children:[e.jsx("p",{children:"집계된 데이터가 없어요."}),e.jsx("p",{children:"축제가 시작되면 순위를 표시할게요."})]}),e.jsx("ul",{children:c.map(s=>{const l=s.rankChange>0,i=s.rankChange<0,o=s.rankChange===0;return e.jsxs("li",{className:`flex h-[54px] justify-between items-center p-2 rounded relative ${s.isCurrentBooth?"bg-[#F5F8FA] w-[103%] left-1/2 -translate-x-1/2 rounded-[10px] px-[2.5%]":""}`,children:[e.jsxs("div",{className:"flex items-center w-1/2",children:[e.jsx("span",{className:"text-14-semibold text-gray-600 w-[30px] h-[23px]",children:s.rank}),e.jsx("div",{className:"w-9 h-9 rounded-full overflow-hidden mr-[10px]",children:e.jsx("img",{src:s.profileImageUrl,alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex items-center text-sm gap-2",children:[e.jsx("span",{className:"text-16-semibold text-black",children:s.name}),e.jsx("span",{className:"text-[12px] text-gray-400",children:s.department})]})]}),e.jsxs("div",{className:"flex items-center justify-between w-1/2 gap-3",children:[e.jsx("div",{}),e.jsxs("span",{className:"flex text-16-medium text-black",children:[s.salesCount,"건"]}),e.jsxs("div",{className:`text-14-semibold w-[40px] h-[29px] py-[5px] flex items-center justify-center rounded-[8px] ${l?"bg-[#FFF1F0] text-[#FF5A1F]":i?"bg-[#EDF4FF] text-[#3A75E5]":"bg-[#F2F2F2] text-[#7E7E7E]"}`,children:[l&&e.jsxs("span",{children:[s.rankChange," ↑"]}),i&&e.jsxs("span",{children:[Math.abs(s.rankChange)," ↓"]}),o&&e.jsx("span",{children:"0 -"})]})]})]},s.rank+s.name)})})]}),L="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cmask%20id='mask0_2475_11738'%20style='mask-type:alpha'%20maskUnits='userSpaceOnUse'%20x='0'%20y='0'%20width='20'%20height='20'%3e%3crect%20width='20'%20height='20'%20fill='%23D9D9D9'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0_2475_11738)'%3e%3cpath%20d='M15.0602%209.9987L8.93523%203.8737C8.7269%203.66536%208.6262%203.41884%208.63315%203.13411C8.64009%202.84939%208.74773%202.60286%208.95607%202.39453C9.1644%202.1862%209.41093%202.08203%209.69565%202.08203C9.98037%202.08203%2010.2269%202.1862%2010.4352%202.39453L16.8311%208.8112C16.9977%208.97786%2017.1227%209.16536%2017.2061%209.3737C17.2894%209.58203%2017.3311%209.79036%2017.3311%209.9987C17.3311%2010.207%2017.2894%2010.4154%2017.2061%2010.6237C17.1227%2010.832%2016.9977%2011.0195%2016.8311%2011.1862L10.4144%2017.6029C10.2061%2017.8112%209.96301%2017.9119%209.68523%2017.9049C9.40745%2017.898%209.1644%2017.7904%208.95607%2017.582C8.74773%2017.3737%208.64357%2017.1272%208.64357%2016.8424C8.64357%2016.5577%208.74773%2016.3112%208.95607%2016.1029L15.0602%209.9987Z'%20fill='%23C1C1C1'/%3e%3c/g%3e%3c/svg%3e",B="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cmask%20id='mask0_1261_7069'%20style='mask-type:alpha'%20maskUnits='userSpaceOnUse'%20x='0'%20y='0'%20width='20'%20height='20'%3e%3crect%20width='20'%20height='20'%20fill='%23D9D9D9'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0_1261_7069)'%3e%3cpath%20d='M4.95833%2010.0003L11.0833%2016.1253C11.2917%2016.3337%2011.3924%2016.5767%2011.3854%2016.8545C11.3785%2017.1323%2011.2708%2017.3753%2011.0625%2017.5837C10.8542%2017.792%2010.6111%2017.8962%2010.3333%2017.8962C10.0556%2017.8962%209.8125%2017.792%209.60417%2017.5837L3.1875%2011.1878C3.02083%2011.0212%202.89583%2010.8337%202.8125%2010.6253C2.72917%2010.417%202.6875%2010.2087%202.6875%2010.0003C2.6875%209.792%202.72917%209.58367%202.8125%209.37534C2.89583%209.167%203.02083%208.9795%203.1875%208.81284L9.60417%202.39617C9.8125%202.18784%2010.059%202.08714%2010.3438%202.09409C10.6285%202.10103%2010.875%202.20867%2011.0833%202.417C11.2917%202.62534%2011.3958%202.86839%2011.3958%203.14617C11.3958%203.42395%2011.2917%203.667%2011.0833%203.87534L4.95833%2010.0003Z'%20fill='%231C1B1F'/%3e%3c/g%3e%3c/svg%3e",U="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cmask%20id='mask0_2722_12292'%20style='mask-type:alpha'%20maskUnits='userSpaceOnUse'%20x='0'%20y='0'%20width='20'%20height='20'%3e%3crect%20width='20'%20height='20'%20fill='%23D9D9D9'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0_2722_12292)'%3e%3cpath%20d='M15.0602%209.9987L8.93523%203.8737C8.7269%203.66536%208.6262%203.41884%208.63315%203.13411C8.64009%202.84939%208.74773%202.60286%208.95607%202.39453C9.1644%202.1862%209.41093%202.08203%209.69565%202.08203C9.98037%202.08203%2010.2269%202.1862%2010.4352%202.39453L16.8311%208.8112C16.9977%208.97786%2017.1227%209.16536%2017.2061%209.3737C17.2894%209.58203%2017.3311%209.79036%2017.3311%209.9987C17.3311%2010.207%2017.2894%2010.4154%2017.2061%2010.6237C17.1227%2010.832%2016.9977%2011.0195%2016.8311%2011.1862L10.4144%2017.6029C10.2061%2017.8112%209.96301%2017.9119%209.68523%2017.9049C9.40745%2017.898%209.1644%2017.7904%208.95607%2017.582C8.74773%2017.3737%208.64357%2017.1272%208.64357%2016.8424C8.64357%2016.5577%208.74773%2016.3112%208.95607%2016.1029L15.0602%209.9987Z'%20fill='%23222222'/%3e%3c/g%3e%3c/svg%3e",_=({sales:t,isTablet:c,onDateChange:n,currentDate:r})=>{const s=new Date().toISOString().slice(0,10),l=r>s,i=r===s;return console.log(t,"오늘 판배 목록"),e.jsxs("div",{className:`bg-white rounded-[16px] flex flex-col justify-between ${c?"p-6 w-full h-full":"p-5 w-[335px] min-h-[150px]"}`,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[e.jsx("p",{className:"text-title-18-bold text-navy-80",children:i?"오늘 매출":"이전 매출"}),e.jsx("p",{className:"text-13-regular text-black-60 mt-1",children:r})]}),e.jsxs("span",{className:"flex",children:[e.jsx("button",{className:`h-5 w-5 ${l?"cursor-not-allowed":"cursor-pointer"}`,onClick:()=>n(-1),children:e.jsx("img",{src:B})}),e.jsx("button",{className:`h-5 w-5 ${l||i?"cursor-not-allowed":"cursor-pointer"}`,onClick:()=>{!l&&!i&&n(1)},children:e.jsx("img",{src:l||i?L:U})})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-baseline",children:[e.jsx("p",{className:"text-headline-22-bold text-navy-80",children:`${((t==null?void 0:t.amount)??0).toLocaleString()}원`}),!!(t!=null&&t.percent)&&t.percent>0&&e.jsx("span",{className:"text-[#FF4103] ml-1",children:`+${t==null?void 0:t.percent}%`})]}),!!(t!=null&&t.diffAmount)&&t.diffAmount>0&&e.jsx("p",{className:"text-13-regular text-black-80",children:`어제보다 ${t.diffAmount.toLocaleString()}원 더 벌었어요!`})]})]})},O=({title:t,date:c,amount:n,isTablet:r})=>e.jsxs("div",{className:`bg-white rounded-[16px]  flex flex-col justify-between ${r?"p-6 w-full h-full":"p-5 w-[335px] min-h-[150px]"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-title-18-bold text-black",children:t}),e.jsx("p",{className:"text-13-regular text-gray-400 mt-1",children:c})]}),e.jsx("div",{className:"flex items-baseline gap-2 mt-4",children:e.jsxs("p",{className:"text-headline-22-bold text-[#1C1C1C]",children:[n.toLocaleString(),"원"]})})]}),E=({sales:t,currentDate:c,popularMenu:n,poupularMenuDisabled:r,isTablet:s,isMobile:l,onDateChange:i})=>{const o=(t==null?void 0:t.todaySalesSum)??0,h=(t==null?void 0:t.yesterdaySalesSum)??0,x=((t==null?void 0:t.cumulativeSalesBeforeYesterday)??0)+o,u=o-h,g=a=>{if(typeof a=="string")return`2${a.replace(/-/g,".")}`;const d=a.getFullYear(),w=String(a.getMonth()+1).padStart(2,"0"),C=String(a.getDate()).padStart(2,"0");return`${d}.${w}.${C}`},m=new Date;new Date(m).setDate(m.getDate()-1);const p=g(m);return console.log(n,"인기 메뉴"),e.jsxs("div",{className:`${s?"grid grid-cols-1 lg:grid-cols-2 gap-[10px] w-full h-[50%]":"flex flex-col gap-[10px]"} ${l?"min-h-[227px]":""}`,children:[e.jsxs("div",{className:"flex flex-col gap-[10px]",children:[e.jsx(_,{sales:{date:c,amount:(t==null?void 0:t.todaySalesSum)??0,diffAmount:u,percent:t!=null&&t.yesterdaySalesSum?parseFloat((((t==null?void 0:t.todaySalesSum)-(t==null?void 0:t.yesterdaySalesSum))/(t==null?void 0:t.yesterdaySalesSum)*100).toFixed(1)):0},currentDate:c,isTablet:s,onDateChange:i}),e.jsx(O,{title:"누적매출",date:`${p} 기준`,amount:x,isTablet:s})]}),e.jsxs("div",{className:`flex flex-col bg-white rounded-[16px] ${r?"justify-center items-center relative":""} ${s?"p-6":"p-[22px] w-[335px] h-[227px]"}`,children:[e.jsxs("div",{className:"flex flex-col ",children:[e.jsx("p",{className:`text-title-18-bold text-navy-80 ${r?"absolute top-6 left-6":""}`,children:"인기 메뉴 TOP 5"}),e.jsx("span",{className:"text-13-regular text-black-60",children:r?"":p}),r?e.jsxs("div",{className:"flex flex-col justify-center items-center text-center text-black-60 text-13-regular",children:[e.jsx("p",{children:"집계된 데이터가 없어요"}),e.jsx("p",{children:"아직 매출이 집계되지 않았을 수 있어요"})]}):""]}),e.jsx("ul",{className:"mt-[25px]",children:!r&&(n??[]).slice(0,5).map((a,d)=>e.jsxs("li",{className:"flex  justify-between h-[52px]",children:[e.jsxs("span",{className:"flex text-16-bold items-center gap-[10px]",children:[d+1," ",e.jsx("div",{className:`h-9 w-9 rounded-[8px] overflow-hidden ${a.imageUrl??"bg-[#788FB6]"}`,children:e.jsx("img",{src:a.imageUrl,className:"h-full w-full object-cover"})}),e.jsx("p",{className:`text-16-semibold ${l?"truncate w-[100px]":""}`,children:a.menuName})]}),e.jsxs("span",{className:"text-16-medium",children:[a.soldCount,"개"]})]},a.menuId))})]})]})},P=()=>{const c=new Date().toISOString().slice(0,10),[n,r]=N.useState(()=>new Date().toISOString().slice(0,10));console.log(c,"오늘날짜");const s=v(),l=s>=768,i=s<432,{data:o}=$(),{data:h}=D(n),{data:x}=b(),u=(o==null?void 0:o.length)===0,g=localStorage.getItem("storeId"),m=(x==null?void 0:x.length)===0,j=o&&o.length>0?o.map(a=>({rank:a.currentRank,name:a.storeName,department:a.departmentName,salesCount:a.orderCount,rankChange:a.delta,isCurrentBooth:g==a.storeId.toString(),profileImageUrl:a.profileUrl})):[],p=a=>{const d=new Date(n);d.setDate(d.getDate()+a),r(d.toISOString().slice(0,10))};return console.log(x,"인기메뉴 원래데이터"),console.log(h,"날짜별 조회"),e.jsxs("div",{className:`w-full flex flex-col items-center ${i?"min-h-[1020px] ":""}`,children:[e.jsx(E,{isTablet:l,isMobile:i,sales:h,currentDate:n,popularMenu:x,poupularMenuDisabled:m,onDateChange:p}),e.jsx(I,{isTablet:l,date:c,data:j,disabled:u})]})};export{P as default};
